(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{436:function(e,v,t){"use strict";t.r(v);var _=t(33),s=Object(_.a)({},(function(){var e=this,v=e.$createElement,t=e._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"第九讲：git-cherry-pick与git-rebase"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#第九讲：git-cherry-pick与git-rebase"}},[e._v("#")]),e._v(" 第九讲：Git cherry-pick与Git rebase")]),e._v(" "),t("h2",{attrs:{id:"前言"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[e._v("#")]),e._v(" 前言")]),e._v(" "),t("p",[e._v("这一节主要介绍"),t("code",[e._v("git cherry-pick")]),e._v("与"),t("code",[e._v("git rebase")]),e._v("的原理及使用。")]),e._v(" "),t("h2",{attrs:{id:"一、git-cherry-pick"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、git-cherry-pick"}},[e._v("#")]),e._v(" 一、"),t("code",[e._v("Git cherry-pick")])]),e._v(" "),t("p",[t("code",[e._v("Git cherry-pick")]),e._v("的作用为移植提交。比如在"),t("code",[e._v("dev")]),e._v("分支错误地进行了两次提交"),t("code",[e._v("2nd")]),e._v("和"),t("code",[e._v("3rd")]),e._v("，如果想要将这两次提交移植到"),t("code",[e._v("master")]),e._v("分支上。采用先删除再添加的方法将会很繁琐，而使用"),t("code",[e._v("cherry-pick")]),e._v("就能轻松实现这一需求。")]),e._v(" "),t("p",[e._v("首先在版本库中创建了两个分支"),t("code",[e._v("master")]),e._v("和"),t("code",[e._v("dev")]),e._v("，并模拟上述场景：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/1.png",alt:"image-20200418213440673"}})]),e._v(" "),t("p",[e._v("可以看到，在"),t("code",[e._v("dev")]),e._v("分支上进行了两次提交，在"),t("code",[e._v("master")]),e._v("分支上只进行了一次提交。现在想要将这两次提交"),t("strong",[e._v("移植")]),e._v("到"),t("code",[e._v("master")]),e._v("分支上。整体分为两步：")]),e._v(" "),t("ul",[t("li",[e._v("**第一步：**将"),t("code",[e._v("dev")]),e._v("分支上多余的两次提交移植到"),t("code",[e._v("master")]),e._v("分支上；")]),e._v(" "),t("li",[e._v("**第二步：**删除"),t("code",[e._v("dev")]),e._v("分支上多余的两次提交；")])]),e._v(" "),t("h3",{attrs:{id:"_1-第一步"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-第一步"}},[e._v("#")]),e._v(" 1.第一步")]),e._v(" "),t("h4",{attrs:{id:"git-cherry-pick-commit-id"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-cherry-pick-commit-id"}},[e._v("#")]),e._v(" "),t("code",[e._v("git cherry-pick commit_id")])]),e._v(" "),t("p",[e._v("首先切换到"),t("code",[e._v("master")]),e._v("分支，然后使用如下命令将"),t("code",[e._v("dev")]),e._v("分支上的两次提交移植到"),t("code",[e._v("master")]),e._v("分支上：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("//移植2nd提交\ngit cherry-pick 009dd\n//移植3rd提交\ngit cherry-pick aec8c\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br")])]),t("p",[t("code",[e._v("009dd")]),e._v("和"),t("code",[e._v("aec8c")]),e._v("分别表示需要移植的提交"),t("code",[e._v("2nd")]),e._v("和"),t("code",[e._v("3rd")]),e._v("的"),t("code",[e._v("SHA1")]),e._v("值：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/2.png",alt:"image-20200418215229274"}})]),e._v(" "),t("p",[e._v("移植过程为：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/3.png",alt:"image-20200418220353735"}})]),e._v(" "),t("ul",[t("li",[t("p",[e._v("如上图所示，执行了两次"),t("code",[e._v("cherry-pick")]),e._v("指令，创建了两个内容与"),t("code",[e._v("2nd、3rd")]),e._v("一致的提交对象"),t("code",[e._v("50477")]),e._v("和"),t("code",[e._v("f05a0")]),e._v("。所以，"),t("code",[e._v("cherry-pick")]),e._v("指令移植提交的实质是：先将需要移植的提交复制一份，再拼接到"),t("code",[e._v("master")]),e._v("分支上，简称"),t("strong",[e._v("先复制，再拼接")]),e._v("；")])]),e._v(" "),t("li",[t("p",[e._v("上面按照顺序先移植了提交"),t("code",[e._v("2nd")]),e._v("再移植提交"),t("code",[e._v("3rd")]),e._v("，不会发生冲突；")])]),e._v(" "),t("li",[t("p",[e._v("不按顺序移植，如先移植提交"),t("code",[e._v("3rd")]),e._v("会发生"),t("strong",[e._v("合并冲突")]),e._v("，需要手动解决：")])])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/4.png",alt:"image-20200418220823727"}})]),e._v(" "),t("p",[e._v("通过"),t("code",[e._v("vi test.txt")]),e._v("查看发生合并冲突的"),t("code",[e._v("test.txt")]),e._v("文件：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/5.png",alt:"image-20200408123432173"}})]),e._v(" "),t("p",[e._v("可以发现"),t("code",[e._v("master")]),e._v("分支上"),t("code",[e._v("initial commit")]),e._v("提交中的文件"),t("code",[e._v("test.txt")]),t("strong",[e._v("直观上")]),e._v("并不与提交"),t("code",[e._v("3rd")]),e._v("中的"),t("code",[e._v("test.txt")]),e._v("冲突，如下图所示：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/6.png",alt:"image-20200408123754034"}})]),e._v(" "),t("p",[e._v("但是为什么会发生合并冲突呢？原因在于"),t("strong",[e._v("三方合并原则")]),e._v("：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/7.png",alt:"image-20200408143344853"}})]),e._v(" "),t("p",[e._v("如上图所示，当想要将"),t("code",[e._v("dev")]),e._v("中的提交"),t("code",[e._v("E")]),e._v("与"),t("code",[e._v("master")]),e._v("分支的提交"),t("code",[e._v("B")]),e._v("合并时，首先要找到"),t("code",[e._v("B")]),e._v("和"),t("code",[e._v("E")]),e._v("的公共父节点"),t("code",[e._v("A")]),e._v("，在"),t("code",[e._v("A")]),e._v("的基础上根据"),t("code",[e._v("B")]),e._v("和"),t("code",[e._v("E")]),e._v("进行三方合并；")]),e._v(" "),t("p",[e._v("了解了三方合并原则后就能解释上面发生合并冲突的原因了：")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("由于提交"),t("code",[e._v("3rd")]),e._v("是基于提交"),t("code",[e._v("2nd")]),e._v("创建的，因此"),t("code",[e._v("3rd")]),e._v("中保留了"),t("code",[e._v("2rd")]),e._v("中对文件的操作记录；")])]),e._v(" "),t("li",[t("p",[e._v("如果直接将"),t("code",[e._v("3rd")]),e._v("拼接到"),t("code",[e._v("initial commit")]),e._v("后面，就会失去提交"),t("code",[e._v("2nd")]),e._v("的记录；")])]),e._v(" "),t("li",[t("p",[e._v("由此提交"),t("code",[e._v("3rd")]),e._v("就不能通过提交"),t("code",[e._v("2nd")]),e._v("找到公共提交节点"),t("code",[e._v("init")]),e._v("，这就会导致合并失败；")])])]),e._v(" "),t("p",[e._v("所以，无论内容是否冲突，合并过程都会出现冲突：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/8.png",alt:"image-20200418222100291"}})]),e._v(" "),t("p",[e._v("**解决方法：**手动合并三步曲：")]),e._v(" "),t("ul",[t("li",[e._v("首先，选择要保留的内容，解决冲突：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/9.png",alt:"image-20200408133308462"}})]),e._v(" "),t("ul",[t("li",[e._v("然后，通过"),t("code",[e._v("git add")]),e._v("将修改信息纳入暂存区：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/10.png",alt:"image-20200408133412891"}})]),e._v(" "),t("ul",[t("li",[e._v("最后，通过"),t("code",[e._v("git commit")]),e._v("提交修改信息：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/11.png",alt:"image-20200418222349351"}})]),e._v(" "),t("p",[e._v("完成后查看"),t("code",[e._v("master")]),e._v("分支的提交历史：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/12.png",alt:"image-20200418222512780"}})]),e._v(" "),t("p",[e._v("可以看到解决冲突，手动合并后，成功完成了整个"),t("code",[e._v("cherry-pick")]),e._v("过程。并且新增的提交是手动合并时进行的提交，而不是直接复制的提交"),t("code",[e._v("3rd")]),e._v("：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/13.png",alt:"image-20200418222844236"}})]),e._v(" "),t("h3",{attrs:{id:"_2-第二步"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-第二步"}},[e._v("#")]),e._v(" 2.第二步")]),e._v(" "),t("p",[e._v("此时两分支的状态为：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/14.png",alt:"image-20200418223143850"}})]),e._v(" "),t("p",[e._v("接下来就要删除"),t("code",[e._v("dev")]),e._v("分支上错误的两次提交"),t("code",[e._v("2nd")]),e._v("和"),t("code",[e._v("3rd")]),e._v("，相当于版本回退；可以使用三种方法："),t("code",[e._v("revert")]),e._v("、"),t("code",[e._v("reset")]),e._v("和"),t("code",[e._v("checkout")]),e._v("，这里演示"),t("code",[e._v("checkout")]),e._v("和"),t("code",[e._v("reset")]),e._v("两种方法。")]),e._v(" "),t("h4",{attrs:{id:"使用checkout"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用checkout"}},[e._v("#")]),e._v(" 使用"),t("code",[e._v("checkout")])]),e._v(" "),t("p",[e._v("首先切换到"),t("code",[e._v("dev")]),e._v("分支，然后通过以下指令切换到提交"),t("code",[e._v("initial commit")]),e._v("：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("//dd703是提交initial_commit的SHA1值\ngit checkout dd703\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("此时该节点处于游离状态：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/15.png",alt:"image-20200418223451519"}})]),e._v(" "),t("p",[e._v("然后再删除"),t("code",[e._v("dev")]),e._v("分支：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/16.png",alt:"image-20200418223548734"}})]),e._v(" "),t("p",[e._v("由于之前修改的"),t("code",[e._v("dev")]),e._v("分支没有与"),t("code",[e._v("master")]),e._v("进行合并，所以删除时需要使用参数"),t("code",[e._v("-D")]),e._v("强制删除。")]),e._v(" "),t("p",[e._v("删除后，剩下"),t("code",[e._v("master")]),e._v("分支与游离提交。此时再通过以下指令将游离的节点设置为"),t("code",[e._v("dev")]),e._v("分支即可：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git checkout -b dev\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/17.png",alt:"image-20200418223939367"}})]),e._v(" "),t("p",[e._v('由此通过"'),t("strong",[e._v("偷天换日")]),e._v('"的方式使'),t("code",[e._v("dev")]),e._v("分支回到了错误提交前的状态；")]),e._v(" "),t("h4",{attrs:{id:"使用reset"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用reset"}},[e._v("#")]),e._v(" 使用"),t("code",[e._v("reset")])]),e._v(" "),t("p",[e._v("由于使用"),t("code",[e._v("checkout")]),e._v("只是移动了"),t("code",[e._v("HEAD")]),e._v("指针，没移动"),t("code",[e._v("dev")]),e._v("分支指针，所以会出现游离提交节点；而"),t("code",[e._v("reset")]),e._v("会同步移动"),t("code",[e._v("HEAD")]),e._v("和"),t("code",[e._v("dev")]),e._v("分支指针，不会造成这样的问题。所以这里使用"),t("code",[e._v("reset")]),e._v("进行版本回退会简单很多：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git reset --hard dd703\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/18.png",alt:"image-20200418224610750"}})]),e._v(" "),t("h2",{attrs:{id:"二、git-rebase简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、git-rebase简介"}},[e._v("#")]),e._v(" 二、"),t("code",[e._v("git rebase")]),e._v("简介")]),e._v(" "),t("p",[e._v("首先，"),t("code",[e._v("rebase")]),e._v("有两个意思："),t("strong",[e._v("变基")]),e._v("、"),t("strong",[e._v("衍合")]),e._v("，即变换分支的参考基点。默认情况下，分支会以分支上的第一次提交作为基点，如下图所示"),t("code",[e._v("master")]),e._v("分支默认以提交"),t("code",[e._v("1st")]),e._v("作为基点：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/19.png",alt:"image-20200409151236167"}})]),e._v(" "),t("p",[e._v("如果以提交"),t("code",[e._v("4th")]),e._v("作为"),t("code",[e._v("master")]),e._v("分支的基点，"),t("code",[e._v("master")]),e._v("分支就会变为：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/20.png",alt:"image-20200409151428243"}})]),e._v(" "),t("p",[e._v("这个变化基点的过程就称之为变基（"),t("code",[e._v("rebase")]),e._v("）；")]),e._v(" "),t("p",[t("code",[e._v("rebase")]),e._v("与"),t("code",[e._v("merge")]),e._v("十分相似，不过二者的工作方式有着显著的差异。比如：将"),t("code",[e._v("A")]),e._v("和"),t("code",[e._v("B")]),e._v("两分支进行合并：")]),e._v(" "),t("ul",[t("li",[e._v("在"),t("code",[e._v("A")]),e._v("分支上执行"),t("code",[e._v("git merge B")]),e._v("，表示的是将"),t("code",[e._v("B")]),e._v("分支"),t("strong",[e._v("合并到")]),t("code",[e._v("A")]),e._v("分支上；")]),e._v(" "),t("li",[e._v("而在"),t("code",[e._v("A")]),e._v("分支上执行"),t("code",[e._v("git rebase B")]),e._v("，则表示将"),t("code",[e._v("A")]),e._v("分支通过变基"),t("strong",[e._v("合并到")]),t("code",[e._v("B")]),e._v("分支上；")])]),e._v(" "),t("h2",{attrs:{id:"三、merge与rebase"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、merge与rebase"}},[e._v("#")]),e._v(" 三、"),t("code",[e._v("merge")]),e._v("与"),t("code",[e._v("rebase")])]),e._v(" "),t("h3",{attrs:{id:"_1-采用merge合并分支"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-采用merge合并分支"}},[e._v("#")]),e._v(" 1.采用"),t("code",[e._v("merge")]),e._v("合并分支")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/21.png",alt:"image-20200408232708342"}})]),e._v(" "),t("p",[e._v("现在有两个分支"),t("code",[e._v("origin")]),e._v("和"),t("code",[e._v("mywork")]),e._v("，如果想要将"),t("code",[e._v("origin")]),e._v("分支"),t("strong",[e._v("合并到")]),t("code",[e._v("mywork")]),e._v("分支上。根据三方合并原则，需要在"),t("code",[e._v("c4")]),e._v("、"),t("code",[e._v("c6")]),e._v("和它们的公共父提交节点"),t("code",[e._v("c2")]),e._v("的基础上进行合并：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/22.png",alt:"image-20200408232523880"}})]),e._v(" "),t("p",[e._v("合并后产生一次新的提交"),t("code",[e._v("c7")]),e._v("，该提交有两个父节点"),t("code",[e._v("c4")]),e._v("和"),t("code",[e._v("c6")]),e._v("。具体的合并方式为：如果没有冲突"),t("code",[e._v("git")]),e._v("就会自动采用"),t("code",[e._v("Fast-forward")]),e._v("方式进行合并，有冲突就解决冲突再进行手动合并。")]),e._v(" "),t("h3",{attrs:{id:"_2-采用rebase合并分支"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-采用rebase合并分支"}},[e._v("#")]),e._v(" 2.采用"),t("code",[e._v("rebase")]),e._v("合并分支")]),e._v(" "),t("p",[e._v("由于是"),t("code",[e._v("mywork")]),e._v("分支需要变基合并到"),t("code",[e._v("origin")]),e._v("分支上，所以首先切换到"),t("code",[e._v("mywork")]),e._v("分支（注意这里与采用"),t("code",[e._v("merge")]),e._v("方法时所在的分支相反）：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git checkout mywork\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("再进行合并：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git rebase origin\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("合并后的结果为：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/23.png",alt:"image-20200408232225944"}})]),e._v(" "),t("p",[e._v("**注意：**被合并的分支"),t("code",[e._v("origin")]),t("strong",[e._v("保持不动")]),e._v("，而合并它的分支"),t("code",[e._v("mywork")]),e._v("将自己的提交作为补丁（"),t("code",[e._v("patch")]),e._v("）一个个应用（"),t("code",[e._v("applying")]),e._v("）到分支"),t("code",[e._v("origin")]),e._v("指向的提交后面；")]),e._v(" "),t("p",[e._v("在这个过程中"),t("code",[e._v("git")]),e._v("会自动创建"),t("code",[e._v("c5'")]),e._v("和"),t("code",[e._v("c6'")]),e._v("。原来的"),t("code",[e._v("c5")]),e._v("和"),t("code",[e._v("c6")]),e._v("就没用了，会被"),t("code",[e._v("git gc")]),e._v("回收。合并后分支"),t("code",[e._v("mywork")]),e._v("的提交记录变成了一条直线：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/24.png",alt:"image-20200408231936193"}})]),e._v(" "),t("blockquote",[t("p",[e._v("也就是说："),t("code",[e._v("rebase")]),e._v("会将被合并分支（"),t("code",[e._v("mywork")]),e._v("）上的提交应用到合并分支（"),t("code",[e._v("origin")]),e._v("）上，并且修改被合并分支（"),t("code",[e._v("mywork")]),e._v("）的提交记录。")])]),e._v(" "),t("h2",{attrs:{id:"四、rebase原理分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、rebase原理分析"}},[e._v("#")]),e._v(" 四、"),t("code",[e._v("rebase")]),e._v("原理分析")]),e._v(" "),t("p",[e._v("如图所示，"),t("code",[e._v("master")]),e._v("和"),t("code",[e._v("dev")]),e._v("分支都以提交节点"),t("code",[e._v("A")]),e._v("为基准点：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/25.png",alt:"image-20200418232253571"}})]),e._v(" "),t("p",[e._v("如果"),t("code",[e._v("dev")]),e._v("分支想要变换"),t("code",[e._v("A")]),e._v("这个基准点，那么：")]),e._v(" "),t("p",[e._v("**第一步：**切换到"),t("code",[e._v("dev")]),e._v("分支上；")]),e._v(" "),t("p",[e._v("**第二步：**执行"),t("code",[e._v("git rebase master")]),e._v("，过程如下；")]),e._v(" "),t("blockquote",[t("p",[e._v("上述命令中"),t("code",[e._v("rebase")]),e._v("参数后面指定的就是变更后的基准点：")]),e._v(" "),t("ul",[t("li",[e._v("如果是分支，如"),t("code",[e._v("master")]),e._v("，基准点为该分支的最新提交节点，也就是"),t("code",[e._v("C")]),e._v("；")]),e._v(" "),t("li",[e._v("如果是一个"),t("code",[e._v("commit_id")]),e._v("，基准点为该"),t("code",[e._v("commit_id")]),e._v("对应的提交节点；")])])]),e._v(" "),t("h3",{attrs:{id:"_1-基准点为分支"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-基准点为分支"}},[e._v("#")]),e._v(" 1.基准点为分支")]),e._v(" "),t("p",[e._v("沿用以上模型：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/26.png",alt:"image-20200418232806243"}})]),e._v(" "),t("ul",[t("li",[e._v("首先，将"),t("code",[e._v("dev")]),e._v("分支上除了基准点"),t("code",[e._v("A")]),e._v("外的所有节点复制一份，即"),t("code",[e._v("D'")]),e._v("和"),t("code",[e._v("E'")]),e._v("，作为补丁备用，并将分支"),t("code",[e._v("dev")]),e._v("指向新基准点"),t("code",[e._v("C")]),e._v("：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/27.png",alt:"image-20200418232419176"}})]),e._v(" "),t("ul",[t("li",[e._v("然后，按原来"),t("code",[e._v("dev")]),e._v("上的节点顺序（"),t("code",[e._v("D->E")]),e._v("）将补丁应用（"),t("code",[e._v("Patch Applying")]),e._v("）到新基准点"),t("code",[e._v("C")]),e._v("后面，并同时改变分支"),t("code",[e._v("dev")]),e._v("指向：")])]),e._v(" "),t("p",[t("strong",[e._v("追加补丁"),t("code",[e._v("D'")]),e._v("：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/28.png",alt:"image-20200418232650653"}})]),e._v(" "),t("p",[e._v("每次向新基准点应用补丁时，都会出现"),t("strong",[e._v("三个选项")]),e._v("：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/29.png",alt:"image-20200418232951097"}})]),e._v(" "),t("h4",{attrs:{id:"git-rebase-continue"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-rebase-continue"}},[e._v("#")]),e._v(" "),t("code",[e._v("git rebase --continue")])]),e._v(" "),t("p",[e._v("该选项表示：解决了合并冲突后，继续应用剩余补丁"),t("code",[e._v("E'")]),e._v("：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/30.png",alt:"image-20200418233223765"}})]),e._v(" "),t("h4",{attrs:{id:"git-rebase-skip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-rebase-skip"}},[e._v("#")]),e._v(" "),t("code",[e._v("git rebase --skip")])]),e._v(" "),t("p",[e._v("该选项表示：跳过当前补丁，继续应用下一个补丁：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/31.png",alt:"image-20200418233400640"}})]),e._v(" "),t("p",[e._v("如果一直执行该选项，直到应用完分支"),t("code",[e._v("dev")]),e._v("上的补丁，结束"),t("code",[e._v("rebase")]),e._v("后，两分支的状态为：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/32.png",alt:"image-20200418233514562"}})]),e._v(" "),t("h4",{attrs:{id:"git-rebase-abort"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#git-rebase-abort"}},[e._v("#")]),e._v(" "),t("code",[e._v("git rebase --abort")])]),e._v(" "),t("p",[e._v("该选项表示：终止"),t("code",[e._v("rebase")]),e._v("操作，回到执行"),t("code",[e._v("rebase")]),e._v("指令前的状态：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/33.png",alt:"image-20200418233837513"}})]),e._v(" "),t("h3",{attrs:{id:"_2-基准点为提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-基准点为提交"}},[e._v("#")]),e._v(" 2.基准点为提交")]),e._v(" "),t("h4",{attrs:{id:"过程详解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#过程详解"}},[e._v("#")]),e._v(" 过程详解")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/34.png",alt:"image-20200409184756113"}})]),e._v(" "),t("p",[e._v("如图所示，若将提交节点"),t("code",[e._v("B")]),e._v("作为基准点，在当前"),t("code",[e._v("test")]),e._v("分支上执行：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git rebase 3ccc8\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("会直接将原来的节点"),t("code",[e._v("C")]),e._v("和"),t("code",[e._v("D")]),e._v("应用到新基准点"),t("code",[e._v("B")]),e._v("后，相当于没有发生变化，这个变基的过程为：")]),e._v(" "),t("ul",[t("li",[e._v("首先，将基准点和"),t("code",[e._v("test")]),e._v("分支指向改变为节点"),t("code",[e._v("B")]),e._v("，并将"),t("code",[e._v("test")]),e._v("分支上基准点往后的提交节点作为补丁：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/35.png",alt:"image-20200409195531185"}})]),e._v(" "),t("ul",[t("li",[e._v("然后，按顺序将补丁"),t("code",[e._v("C")]),e._v("和"),t("code",[e._v("D")]),e._v("应用到新基准点"),t("code",[e._v("B")]),e._v("后面：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/36.png",alt:"image-20200409202803624"}})]),e._v(" "),t("ul",[t("li",[e._v("最后，"),t("code",[e._v("test")]),e._v("分支的状态为：")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/37.png",alt:"image-20200409202843582"}})]),e._v(" "),t("p",[e._v("所以，直接执行"),t("code",[e._v("git rebase 678e0")]),e._v("不会有任何变化：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/38.png",alt:"image-20200409203900098"}})]),e._v(" "),t("p",[e._v("但是，我们可以通过在"),t("code",[e._v("rebase")]),e._v("中添加参数"),t("code",[e._v("-i")]),e._v("，进入"),t("code",[e._v("rebase")]),e._v("交互模式，这样就能在"),t("code",[e._v("rebase")]),e._v("操作过程中对特定的补丁进行一系列操作；")]),e._v(" "),t("h4",{attrs:{id:"实战演示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实战演示"}},[e._v("#")]),e._v(" 实战演示")]),e._v(" "),t("p",[e._v("首先在"),t("code",[e._v("test")]),e._v("分支上进行了四次提交：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/39.png",alt:"image-20200409191637780"}})]),e._v(" "),t("p",[e._v("执行以下指令将"),t("code",[e._v("test")]),e._v("分支的基准点变为提交节点"),t("code",[e._v("B")]),e._v("（"),t("code",[e._v("678e0")]),e._v("），并进行变基：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git rebase -i 678e0\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("执行该指令后，会进入"),t("code",[e._v("vim")]),e._v("编辑器：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/40.png",alt:"image-20200409192056322"}})]),e._v(" "),t("p",[e._v("可以根据需要将"),t("code",[e._v("pick")]),e._v("参数，改变为下面代表不同作用的参数；这样就可以对节点"),t("code",[e._v("C")]),e._v("和"),t("code",[e._v("D")]),e._v("进行不同的操作了。比如：")]),e._v(" "),t("ul",[t("li",[t("code",[e._v("pick")]),e._v("：默认参数，表示不对提交节点进行任何操作，直接应用原提交节点。不创建新提交；")]),e._v(" "),t("li",[t("code",[e._v("reword")]),e._v("：应用复制过后的原提交节点，但是可以编辑该节点的提交信息。通过这个参数，可以修改特定提交的提交信息。会创建新的提交；")]),e._v(" "),t("li",[t("code",[e._v("edit")]),e._v("：应用复制过后的原提交节点，会在设置了该参数的补丁上停止"),t("code",[e._v("rebase")]),e._v("操作。待修改完该补丁后，调用"),t("code",[e._v("git rebase --continue")]),e._v("继续进行"),t("code",[e._v("rebase")]),e._v("。会创建新的提交；")]),e._v(" "),t("li",[t("code",[e._v("squash")]),e._v("：将新基点后面的全部提交节点进行合并，也就是将这里的"),t("code",[e._v("C")]),e._v("和"),t("code",[e._v("D")]),e._v("两个节点进行合并。会创建新的提交；")]),e._v(" "),t("li",[e._v("还有其他参数这里就不一一介绍了。")])]),e._v(" "),t("p",[e._v("这次直接使用默认的"),t("code",[e._v("pick")]),e._v("参数，通过"),t("code",[e._v(":wq")]),e._v("保存并退出"),t("code",[e._v("vim")]),e._v("编辑器，完成"),t("code",[e._v("rebase")]),e._v("操作：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/41.png",alt:"image-20200409194956051"}})]),e._v(" "),t("p",[e._v("执行"),t("code",[e._v("rebase")]),e._v("操作前：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/42.png",alt:"image-20200409191637780"}})]),e._v(" "),t("p",[e._v("可以看到当新基准点为特定提交时：")]),e._v(" "),t("ul",[t("li",[e._v("在"),t("code",[e._v("rebase")]),e._v("的过程中使用默认参数"),t("code",[e._v("pick")]),e._v("，并不会像当新基准点为分支时那样创建新的提交；")]),e._v(" "),t("li",[e._v("而一旦使用其他参数（如"),t("code",[e._v("reword")]),e._v("）对补丁进行了修改，就会创建新的提交；")])]),e._v(" "),t("h2",{attrs:{id:"五、rebase注意事项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、rebase注意事项"}},[e._v("#")]),e._v(" 五、"),t("code",[e._v("rebase")]),e._v("注意事项")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("不要对"),t("code",[e._v("master")]),e._v("分支执行"),t("code",[e._v("rebase")]),e._v("，否则会引起很多的问题（"),t("code",[e._v("master")]),e._v("一定是远程共享的分支）；")])]),e._v(" "),t("li",[t("p",[e._v("一般来说，执行"),t("code",[e._v("rebase")]),e._v("的分支都是自己的本地分支，千万不要在与其他人共享的远程分支上使用"),t("code",[e._v("rebase")]),e._v("；")]),e._v(" "),t("p",[e._v("这不难理解，远程分支上的代码可能已经被其他人克隆到本地了，如果通过"),t("code",[e._v("rebase")]),e._v("修改了远程分支的提交历史，这样其他人每次拉取代码到本地时，就都需要进行复杂的合并。")])]),e._v(" "),t("li",[t("p",[e._v("所以，本地的非"),t("code",[e._v("master")]),e._v("分支合并时推荐使用"),t("code",[e._v("git rebase")]),e._v("，其他分支的合并推荐使用"),t("code",[e._v("git merge")]),e._v("；")])])]),e._v(" "),t("p",[t("strong",[e._v("注意："),t("code",[e._v("git merge")]),e._v("和"),t("code",[e._v("git rebase")]),e._v("的显著区别是，前者不会修改"),t("code",[e._v("git")]),e._v("的提交记录，而后者会！")])]),e._v(" "),t("h2",{attrs:{id:"六、rebase应用场合"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六、rebase应用场合"}},[e._v("#")]),e._v(" 六、"),t("code",[e._v("rebase")]),e._v("应用场合")]),e._v(" "),t("h3",{attrs:{id:"_1-合并分支"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-合并分支"}},[e._v("#")]),e._v(" 1.合并分支")]),e._v(" "),t("p",[e._v("由于"),t("code",[e._v("git merge")]),e._v("采用的是"),t("strong",[e._v("三方合并")]),e._v("的原则，没有公共提交节点就无法进行合并，此时可以采用"),t("code",[e._v("rebase")]),e._v("进行合并。如下图所示：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/43.png",alt:"image-20200411205020369"}})]),e._v(" "),t("p",[e._v("本地"),t("code",[e._v("master")]),e._v("与远程"),t("code",[e._v("master")]),e._v("分支没有公共提交节点，无法采用"),t("code",[e._v("git merge")]),e._v("合并。可采用"),t("code",[e._v("rebase")]),e._v("进行合并：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("//origin/master代表着远程master分支\ngit rebase origin/master\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])]),t("p",[e._v("合并后本地"),t("code",[e._v("master")]),e._v("分支的状态为：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/44.png",alt:"image-20200411205034662"}})]),e._v(" "),t("h3",{attrs:{id:"_2-修改特定提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-修改特定提交"}},[e._v("#")]),e._v(" 2.修改特定提交")]),e._v(" "),t("p",[e._v("以下情况就适合使用"),t("code",[e._v("rebase")]),e._v("来解决，当回退版本并进行修改时：")]),e._v(" "),t("p",[e._v("比如在"),t("code",[e._v("master")]),e._v("分支上进行了"),t("code",[e._v("3")]),e._v("次提交：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/45.png",alt:"image-20200419174116301"}})]),e._v(" "),t("p",[e._v("回退到第二次提交"),t("code",[e._v("2nd")]),e._v("，并对提交信息进行修改：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/46.png",alt:"image-20200419174313522"}})]),e._v(" "),t("p",[e._v("当我们回到原来的第三次提交"),t("code",[e._v("3rd")]),e._v("时，会发现之前的修改并没有被保存：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/47.png",alt:"image-20200419174404816"}})]),e._v(" "),t("p",[e._v("此时可以使用"),t("code",[e._v("rebase")]),e._v("，将提交"),t("code",[e._v("1st")]),e._v("作为新的提交节点（正如第四大点讲解的）。首先执行：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git rebase -i 5ab3f\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("通过添加参数"),t("code",[e._v("-i")]),e._v("进入交互模式，将提交"),t("code",[e._v("2nd")]),e._v("默认的"),t("code",[e._v("pick")]),e._v("参数修改为"),t("code",[e._v("reword")]),e._v("参数：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/48.png",alt:"image-20200419174618553"}})]),e._v(" "),t("p",[e._v("保存并退出后，进入修改提交信息界面：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/49.png",alt:"image-20200419174829838"}})]),e._v(" "),t("p",[e._v("保存并退出，由此完成修改：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/50.png",alt:"image-20200419174935598"}})]),e._v(" "),t("h2",{attrs:{id:"七、rebase实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#七、rebase实战"}},[e._v("#")]),e._v(" 七、"),t("code",[e._v("rebase")]),e._v("实战")]),e._v(" "),t("p",[e._v("为了演示，额外创建两个分支"),t("code",[e._v("dev")]),e._v("和"),t("code",[e._v("test")]),e._v("，分别在两个分支上进行两次提交:")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/51.png",alt:"image-20200419150528809"}})]),e._v(" "),t("p",[e._v("它们有一个共同的父节点提交节点"),t("code",[e._v("init")]),e._v("，此时本地仓库的状态如下：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/52.png",alt:"image-20200419154602095"}})]),e._v(" "),t("ul",[t("li",[t("p",[e._v("由于要对"),t("code",[e._v("test")]),e._v("分支进行变基，从而"),t("strong",[e._v("合并到")]),t("code",[e._v("dev")]),e._v("分支上，所以需要先切换到"),t("code",[e._v("test")]),e._v("分支上，这与"),t("code",[e._v("merge")]),e._v("操作是相反的；")])]),e._v(" "),t("li",[t("p",[e._v("随后在"),t("code",[e._v("test")]),e._v("分支上执行如下命令对该分支进行变基：")])])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git rebase dev\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("该指令翻译过来就是：我"),t("code",[e._v("test")]),e._v(" 分支，现在要重新定义我的基准点，即使用 "),t("code",[e._v("dev")]),e._v(" 分支指向的提交作为我新的基准点。过程如下：")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("首先，将"),t("code",[e._v("test")]),e._v("分支上的提交（补丁）"),t("code",[e._v("tes1")]),e._v("应用到"),t("strong",[e._v("新基准点")]),t("code",[e._v("dev2")]),e._v("尾部，出现了合并冲突：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/53.png",alt:"image-20200419151735485"}})]),e._v(" "),t("p",[e._v("查看状态，发现"),t("code",[e._v("test")]),e._v("分支变基过程中的新基准点正是"),t("code",[e._v("dev")]),e._v("分支指向的提交"),t("code",[e._v("361be")]),e._v("，即提交节点"),t("code",[e._v("dev2")]),e._v("：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/54.png",alt:"image-20200419152146120"}})])])]),e._v(" "),t("p",[e._v("如图所示，此时有三个选项：")]),e._v(" "),t("ul",[t("li",[t("p",[t("strong",[e._v("选项一：")]),t("code",[e._v("git rebase --abort")]),e._v("：表示终止"),t("code",[e._v("rebase")]),e._v("操作，恢复到操作前；")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("选项二：")]),t("code",[e._v("git rebase --skip")]),e._v("：表示丢弃当前"),t("code",[e._v("test")]),e._v("分支的补丁，如果一直执行该选项，变基完成后，两分支的状态如下所示：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/55.png",alt:"image-20200419154352758"}})]),e._v(" "),t("p",[e._v("即此时"),t("code",[e._v("test")]),e._v("分支与"),t("code",[e._v("dev")]),e._v("分支上具有相同的文件：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/56.png",alt:"image-20200419155017163"}})]),e._v(" "),t("p",[e._v("并且"),t("code",[e._v("test")]),e._v("分支上的提交记录被改变为了"),t("code",[e._v("dev")]),e._v("分支上的提交记录：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/57.png",alt:"image-20200419153242071"}})]),e._v(" "),t("p",[e._v("这就是一直执行选项"),t("code",[e._v("git rebase --skip")]),e._v("，丢弃全部"),t("code",[e._v("test")]),e._v("分支补丁的结果：")])]),e._v(" "),t("li",[t("p",[t("strong",[e._v("选项三：")]),t("code",[e._v("git rebase --continue")]),e._v("：解决冲突，手动合并后，继续变基；")]),e._v(" "),t("p",[e._v("在"),t("code",[e._v("dev")]),e._v("分支上新增两次提交"),t("code",[e._v("dev3")]),e._v("和"),t("code",[e._v("dev4")]),e._v("：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/58.png",alt:"image-20200419153831132"}})]),e._v(" "),t("p",[e._v("切换回"),t("code",[e._v("test")]),e._v("分支同样新增两次提交"),t("code",[e._v("tes3")]),e._v("和"),t("code",[e._v("tes4")]),e._v("：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/59.png",alt:"image-20200419154032932"}})]),e._v(" "),t("p",[e._v("此时两分支的状态为：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/60.png",alt:"image-20200419184609655"}})]),e._v(" "),t("p",[e._v("随后在"),t("code",[e._v("test")]),e._v("分支上执行"),t("code",[e._v("git rebase dev")]),e._v("，在处理"),t("code",[e._v("test")]),e._v("分支上的第一个补丁"),t("code",[e._v("tes3")]),e._v("时出现冲突：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/61.png",alt:"image-20200419155615321"}})]),e._v(" "),t("p",[e._v("打开冲突文件"),t("code",[e._v("test.txt")]),e._v("，手动解决冲突：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/62.png",alt:"image-20200419155711866"}})]),e._v(" "),t("p",[e._v("删除"),t("code",[e._v("4、7、9")]),e._v("行：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/63.png",alt:"image-20200419155812608"}})]),e._v(" "),t("p",[e._v("解决冲突后，执行"),t("code",[e._v("git add")]),e._v("将对文件``test.txt`的修改操作纳入暂存区，标识已解决冲突：")]),e._v(" "),t("blockquote",[t("p",[e._v("**注意：**这里并不需要进行一次提交，继续执行"),t("code",[e._v("rebase")]),e._v("操作即可；")])]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/64.png",alt:"image-20200419160220448"}})]),e._v(" "),t("p",[e._v("随后再执行"),t("code",[e._v("git rebase --continue")]),e._v("，继续处理"),t("code",[e._v("test")]),e._v("分支的下一个补丁（变基）：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/65.png",alt:"image-20200419160305488"}})]),e._v(" "),t("p",[t("code",[e._v("rebase")]),e._v("结束后，查看"),t("code",[e._v("test")]),e._v("分支的提交记录：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/66.png",alt:"image-20200419160412284"}})]),e._v(" "),t("p",[e._v("可以发现修改了"),t("code",[e._v("test")]),e._v("分支的提交历史，达到了预期的合并效果。")]),e._v(" "),t("p",[e._v("并且，此时"),t("code",[e._v("test")]),e._v("分支上的"),t("code",[e._v("tes3")]),e._v("与"),t("code",[e._v("tes4")]),e._v("两次提交的"),t("code",[e._v("SHA1")]),e._v("值与执行"),t("code",[e._v("rebase")]),e._v("前这两次提交的"),t("code",[e._v("SHA1")]),e._v("值是不一样的：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/67.png",alt:"image-20200419160741986"}})]),e._v(" "),t("p",[e._v("这也就验证了，"),t("code",[e._v("git")]),e._v("在"),t("code",[e._v("rebase")]),e._v("过程中会自动创建提交节点的结论。此时"),t("code",[e._v("dev")]),e._v("分支与"),t("code",[e._v("test")]),e._v("分支的状态如下所示：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/68.png",alt:"image-20200419161342071"}})]),e._v(" "),t("p",[e._v("如果在"),t("code",[e._v("dev")]),e._v("分支上执行"),t("code",[e._v("git merge test")]),e._v("，采用的应当是"),t("code",[e._v("Fast-forward")]),e._v("方式：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/69.png",alt:"image-20200419161456806"}})]),e._v(" "),t("p",[e._v("使用"),t("code",[e._v("gitk")]),e._v("可以更加直观地表示这一状态：")]),e._v(" "),t("p",[t("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson9/70.png",alt:"image-20200419161529226"}})])])]),e._v(" "),t("blockquote",[t("p",[e._v("细心的你可能已经发现了，"),t("code",[e._v("rebase")]),e._v("与"),t("code",[e._v("cherry-pick")]),e._v("十分类似。只不过"),t("code",[e._v("cherry-pick")]),e._v("不会修改分支提交记录，而"),t("code",[e._v("rebase")]),e._v("会。")])]),e._v(" "),t("h2",{attrs:{id:"八、merge与rebase的选择"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#八、merge与rebase的选择"}},[e._v("#")]),e._v(" 八、"),t("code",[e._v("merge")]),e._v("与"),t("code",[e._v("rebase")]),e._v("的选择")]),e._v(" "),t("p",[e._v("使用"),t("code",[e._v("rebase")]),e._v("时要遵循"),t("code",[e._v("rebase")]),e._v("的黄金法则：永远不要在公共分支上使用"),t("code",[e._v("rebase")]),e._v("。公共分支可以理解为"),t("code",[e._v("master")]),e._v("分支。由于"),t("code",[e._v("rebase")]),e._v("会重写分支提交记录，因此会给项目的回溯带来危险。以下为它与"),t("code",[e._v("merge")]),e._v("的区别：")]),e._v(" "),t("ul",[t("li",[t("p",[t("code",[e._v("merge")]),e._v("是一个合并操作，使用"),t("code",[e._v("git merge")]),e._v("提交历史会出现分叉，显得不是那么简洁。但是，它的好处在于不会修改任何一次提交，会完整地将所有的提交都保存下来，方便回溯。"),t("strong",[e._v("并且只能合并有公共提交节点的分支；")])])]),e._v(" "),t("li",[t("p",[t("code",[e._v("rebase")]),e._v("是没有合并操作的，它只是将当前分支所做的修改复制到了目标分支的最后一次提交上。所以可以不受"),t("strong",[e._v("三方合并原则")]),e._v("约束，合并没有公共提交节点的分支；")]),e._v(" "),t("p",[e._v("使用"),t("code",[e._v("rebase")]),e._v("会修改提交历史，得到的分支提交历史更加整洁。就好像写书，只会出版最终版本，之前的书稿并不会出版。但是，一定要注意"),t("strong",[e._v("不能在共享的分支上使用"),t("code",[e._v("rebase")])]),e._v("。")])])]),e._v(" "),t("p",[e._v("二者都是很强大的分支整合命令，使用哪个由具体情境决定。")]),e._v(" "),t("h2",{attrs:{id:"九、rebase、reset、revert"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#九、rebase、reset、revert"}},[e._v("#")]),e._v(" 九、"),t("code",[e._v("rebase")]),e._v("、"),t("code",[e._v("reset")]),e._v("、"),t("code",[e._v("revert")])]),e._v(" "),t("p",[e._v("这三个指令的名字很像，容易混淆，下表对比了它们的用途以及区别：")]),e._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[e._v("指令")]),e._v(" "),t("th",{staticStyle:{"text-align":"center"}},[e._v("改变提                      交历史")]),e._v(" "),t("th",{staticStyle:{"text-align":"center"}},[e._v("用途")])])]),e._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("strong",[e._v("Reset")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("是")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("把目前分支的状态设定成某个指定的"),t("code",[e._v("Commit")]),e._v("状态，通常适用于尚未推送的"),t("code",[e._v("Commit")])])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("strong",[e._v("Rebase")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("是")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("不管是新增、修改、删除"),t("code",[e._v("Commit")]),e._v("都相当方便。可用来整理、编辑还未推送的"),t("code",[e._v("Commit")]),e._v("，通常也只适用于尚未推送的"),t("code",[e._v("Commit")])])]),e._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[t("strong",[e._v("Revert")])]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("否")]),e._v(" "),t("td",{staticStyle:{"text-align":"center"}},[e._v("新增一个"),t("code",[e._v("Commit")]),e._v("来反转（取消）另一个"),t("code",[e._v("Commit")]),e._v("内容，原本的"),t("code",[e._v("Commit")]),e._v("依旧会保留在提交历史中。虽然会因此而增加"),t("code",[e._v("Commit")]),e._v("数，但通常比较适用于已经推送的"),t("code",[e._v("Commit")]),e._v("，或者不允许使用"),t("code",[e._v("Reset")]),e._v("或"),t("code",[e._v("Rebase")]),e._v("指令修改提交历史的场合")])])])]),e._v(" "),t("h2",{attrs:{id:"十、git最佳实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#十、git最佳实践"}},[e._v("#")]),e._v(" 十、"),t("code",[e._v("git")]),e._v("最佳实践")]),e._v(" "),t("p",[e._v("学到这里就可以完全理解使用"),t("code",[e._v("git")]),e._v("将本地仓库文件推送到远程仓库的一般步骤了：")]),e._v(" "),t("ul",[t("li",[t("p",[e._v("**第一步：**创建本地仓库：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git init\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("**第二步：**添加用户信息：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git config --global user.name '张三'\ngit config --global user.email 'zhangsan@git.com'\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("**第三步：**添加远程仓库地址：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git remote add origin https://www.github.com/example\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("**第四步：**修改文件；")])]),e._v(" "),t("li",[t("p",[e._v("**第五步：**将工作区中的文件纳入暂存区：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git add .\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("**第六步：**将暂存区中的文件提交到版本库：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git commit -m '注释'\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("**第七步：**与远程仓库进行同步：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git pull --rebase origin master\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("**第八步：**建立本地分支与远程分支的联系，并进行推送：")]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("git push -u origin master\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])])])])}),[],!1,null,null,null);v.default=s.exports}}]);