(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{539:function(t,e,v){"use strict";v.r(e);var _=v(27),s=Object(_.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"第四讲：版本回退的三种方式与stash"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#第四讲：版本回退的三种方式与stash"}},[t._v("#")]),t._v(" 第四讲：版本回退的三种方式与stash")]),t._v(" "),v("h2",{attrs:{id:"前言"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),v("p",[v("code",[t._v("git")]),t._v("作为一款版本控制工具，其最核心的功能就是版本回退，没有之一。熟悉"),v("code",[t._v("git")]),t._v("版本回退的操作能够让你真真正正地放开手脚去开发，不用小心翼翼，怕一不小心删除了不该删除的文件。本节除了介绍版本回退的内容之外，还会介绍"),v("code",[t._v("stash")]),t._v("的使用。")]),t._v(" "),v("h2",{attrs:{id:"一、版本回退"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#一、版本回退"}},[t._v("#")]),t._v(" 一、版本回退")]),t._v(" "),v("p",[t._v("在"),v("code",[t._v("git")]),t._v("中永远有后悔药可吃，总是可以回到"),v("strong",[t._v("版本库")]),t._v("的某一个时刻，这就叫做"),v("strong",[t._v("版本回退")]),t._v("；")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/1.png",alt:"image-20200406144058526"}})]),t._v(" "),v("p",[t._v("如上图所示：当前"),v("code",[t._v("master")]),t._v("分支指针指向"),v("code",[t._v("D")]),t._v("，通过版本回退可以使"),v("code",[t._v("master")]),t._v("指向"),v("code",[t._v("C")]),t._v("、"),v("code",[t._v("B")]),t._v("或"),v("code",[t._v("A")]),t._v("。进行版本回退的命令大体上有三种："),v("code",[t._v("reset")]),t._v("、"),v("code",[t._v("revert")]),t._v("和"),v("code",[t._v("checkout")]),t._v("。下面就来一一讲解：")]),t._v(" "),v("h3",{attrs:{id:"ⅰ-git-reset"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ⅰ-git-reset"}},[t._v("#")]),t._v(" Ⅰ."),v("code",[t._v("git reset")])]),t._v(" "),v("h4",{attrs:{id:"_1-参数"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-参数"}},[t._v("#")]),t._v(" 1.参数")]),t._v(" "),v("p",[v("code",[t._v("reset")]),t._v("命令可以添加很多参数，常用的有"),v("code",[t._v("--mixed")]),t._v("、"),v("code",[t._v("--soft")]),t._v("和"),v("code",[t._v("--hard")]),t._v("三种。下图为一次完整提交的四个阶段：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/2.png",alt:"image-20200412192613526"}})]),t._v(" "),v("p",[t._v("三个参数大体上的区别为：")]),t._v(" "),v("ul",[v("li",[v("code",[t._v("--mixed")]),t._v("：为默认值，等同于"),v("code",[t._v("git reset")]),t._v("。作用为：将文件回退到"),v("strong",[t._v("工作区")]),t._v("，此时会保留"),v("strong",[t._v("工作区")]),t._v("中的文件，但会丢弃"),v("strong",[t._v("暂存区")]),t._v("中的文件；")]),t._v(" "),v("li",[v("code",[t._v("--soft")]),t._v("：作用为：将文件回退到"),v("strong",[t._v("暂存区")]),t._v("，此时会保留"),v("strong",[t._v("工作区")]),t._v("和"),v("strong",[t._v("暂存区")]),t._v("中的文件；")]),t._v(" "),v("li",[v("code",[t._v("--hard")]),t._v("：作用为：将文件回退到"),v("strong",[t._v("修改前")]),t._v("，此时会丢弃"),v("strong",[t._v("工作区")]),t._v("和"),v("strong",[t._v("暂存区")]),t._v("中的文件；")])]),t._v(" "),v("p",[t._v("下面就来详细地讲解它们的使用方法：")]),t._v(" "),v("p",[t._v("首先在"),v("code",[t._v("master")]),t._v("分支进行四次提交，每次提交在"),v("code",[t._v("test.txt")]),t._v("中添加一行文本信息：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/3.png",alt:"image-20200406164503683"}})]),t._v(" "),v("h5",{attrs:{id:"mixed"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mixed"}},[t._v("#")]),t._v(" "),v("code",[t._v("--mixed")])]),t._v(" "),v("p",[t._v("该参数为默认值，作用为：将文件回退到工作区中：如下图所示，将"),v("code",[t._v("test.txt")]),t._v("文件回退一次提交：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/4.png",alt:"image-20200412194811197"}})]),t._v(" "),v("p",[t._v("可以看到第四次提交对"),v("code",[t._v("test.txt")]),t._v("的修改操作被回退到了工作区当中，并且保留了工作区中第四次提交对"),v("code",[t._v("test.txt")]),t._v("所做的修改，所以工作区中的"),v("code",[t._v("test.txt")]),t._v("文件内容与回退前一致。")]),t._v(" "),v("h5",{attrs:{id:"soft"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#soft"}},[t._v("#")]),t._v(" "),v("code",[t._v("--soft")])]),t._v(" "),v("p",[t._v("该参数的作用为：将文件回退到暂存区中：如下图所示，将"),v("code",[t._v("test.txt")]),t._v("文件回退一次提交：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/5.png",alt:"image-20200412195321082"}})]),t._v(" "),v("p",[t._v("可以看到第四次提交对"),v("code",[t._v("test.txt")]),t._v("的修改操作被回退到了暂存区当中，并且保留了工作区和暂存区中第四次提交对"),v("code",[t._v("test.txt")]),t._v("所做的修改，所以，工作区中的文件内容与回退前一致。")]),t._v(" "),v("h5",{attrs:{id:"hard"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#hard"}},[t._v("#")]),t._v(" "),v("code",[t._v("--hard")])]),t._v(" "),v("p",[t._v("该参数的作用为：将文件回退到修改前：如下图所示，将"),v("code",[t._v("test.txt")]),t._v("文件回退一次提交：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/6.png",alt:"image-20200412205112201"}})]),t._v(" "),v("p",[t._v("可以看到"),v("code",[t._v("test.txt")]),t._v("直接回到了进行第四次提交前，此时删除了工作区和暂存区中第四次提交对"),v("code",[t._v("test.txt")]),t._v("所做的修改。所以，工作区变得干净了，"),v("code",[t._v("test.txt")]),t._v("文件内容回退到刚完成第三次提交时。")]),t._v(" "),v("h4",{attrs:{id:"_2-写法"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-写法"}},[t._v("#")]),t._v(" 2.写法")]),t._v(" "),v("p",[t._v("为了方便演示"),v("code",[t._v("reset")]),t._v("的各种使用方法，下面的指令都采用"),v("code",[t._v("--hard")]),t._v("参数。")]),t._v(" "),v("h5",{attrs:{id:"git-reset-hard-head"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-reset-hard-head"}},[t._v("#")]),t._v(" "),v("code",[t._v("git reset --hard HEAD^")])]),t._v(" "),v("p",[v("strong",[t._v("该命令的作用为回退一次提交：")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/7.png",alt:"image-20200406164628192"}})]),t._v(" "),v("p",[t._v("回退后的状态为：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/8.png",alt:"image-20200406164713774"}})]),t._v(" "),v("p",[t._v("可以看到，该方法会同时改变了"),v("code",[t._v("HEAD")]),t._v("和"),v("code",[t._v("master")]),t._v("指针的指向；")]),t._v(" "),v("h5",{attrs:{id:"git-reset-hard-head-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-reset-hard-head-2"}},[t._v("#")]),t._v(" "),v("code",[t._v("git reset --hard HEAD^^")])]),t._v(" "),v("p",[v("strong",[t._v("该命令的作用为回退两次提交：")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/9.png",alt:"image-20200406170323254"}})]),t._v(" "),v("p",[t._v("回退后的状态为：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/10.png",alt:"image-20200406170352024"}})]),t._v(" "),v("p",[t._v("同样，使用"),v("code",[t._v("--hard")]),t._v("参数回退，工作区是干净的；可以看到，该方法也会同时改变"),v("code",[t._v("HEAD")]),t._v("和"),v("code",[t._v("master")]),t._v("指针的指向；")]),t._v(" "),v("h5",{attrs:{id:"git-reset-hard-head-n"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-reset-hard-head-n"}},[t._v("#")]),t._v(" "),v("code",[t._v("git reset --hard HEAD~n")])]),t._v(" "),v("p",[v("strong",[t._v("该命令的作用为回退"),v("code",[t._v("n")]),t._v("次提交：")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/11.png",alt:"image-20200406203027868"}})]),t._v(" "),v("p",[t._v("可以看到使用了"),v("code",[t._v("--hard")]),t._v("参数，回退结果符合预期，并且该方法也会同步修改"),v("code",[t._v("HEAD")]),t._v("和分支"),v("code",[t._v("master")]),t._v("指针的指向。")]),t._v(" "),v("p",[v("strong",[t._v("注意：该方式只能向前回退，不能向后回退")]),t._v("。")]),t._v(" "),v("blockquote",[v("p",[t._v("上述命令中的"),v("code",[t._v("HEAD")]),t._v("可以更换为分支名，比如"),v("code",[t._v("master")]),t._v("：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git reset --hard master~n\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("该命令表示将"),v("code",[t._v("master")]),t._v("分支回退"),v("code",[t._v("n")]),t._v("次提交。由于"),v("code",[t._v("HEAD")]),t._v("始终指向当前分支，所以使用分支名和使用"),v("code",[t._v("HEAD")]),t._v("效果是一样的。")])]),t._v(" "),v("h5",{attrs:{id:"git-reset-hard-commit-id"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-reset-hard-commit-id"}},[t._v("#")]),t._v(" "),v("code",[t._v("git reset --hard commit_id")])]),t._v(" "),v("p",[t._v("**该指令的作用为回退到指定的"),v("code",[t._v("commit id")]),t._v("的提交版本；"),v("strong",[t._v("由于"),v("code",[t._v("commit id")]),t._v("是不会重复的，一般只需要写前几（"),v("code",[t._v("6")]),t._v("）位就可以识别出来。通过"),v("code",[t._v("commit id")]),t._v("的回退方式")]),t._v("既可以向前回退，也可以向后回退。**如下所示，从"),v("code",[t._v("1st commit")]),t._v("往后回退到"),v("code",[t._v("4th commit")]),t._v("，其中"),v("code",[t._v("4th commit")]),t._v("的"),v("code",[t._v("commit id = bdb373...")]),t._v("。")]),t._v(" "),v("p",[t._v("为了熟悉该指令，我们分两种方式进行回退：使用"),v("code",[t._v("--hard")]),t._v("参数与使用默认参数。")]),t._v(" "),v("ul",[v("li",[v("p",[v("strong",[t._v("使用"),v("code",[t._v("--hard")]),t._v("参数")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/12.png",alt:"image-20200406193422130"}})]),t._v(" "),v("p",[t._v("从图中可以看出：通过第四次提交的"),v("code",[t._v("commit_id: bdb373")]),t._v("顺利地从第一次提交向后回退到了第四次提交，并且工作区干净。该方法也同时修改了"),v("code",[t._v("HEAD")]),t._v("和分支"),v("code",[t._v("master")]),t._v("的指向，具体过程为：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/13.png",alt:"image-20200414171228274"}})])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("使用默认参数")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/14.png",alt:"image-20200406193005200"}})]),t._v(" "),v("p",[t._v("可以看到切换回了"),v("code",[t._v("4th commit")]),t._v("，但是工作区的"),v("code",[t._v("test.txt")]),t._v("文件并没有变化；这是因为，在"),v("code",[t._v("4th -> 1st")]),t._v("的过程中，需要在工作区中删除"),v("code",[t._v("test.txt")]),t._v("文件中的"),v("code",[t._v("2nd line、3rd line、4th line")]),t._v("。通过默认参数"),v("code",[t._v("--mixed")]),t._v("，将"),v("code",[t._v("4th commit")]),t._v("对文件的修改回退到了工作区当中，如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/15.png",alt:"image-20200406202451310"}})]),t._v(" "),v("p",[t._v("这个过程丢弃了"),v("strong",[t._v("暂存区")]),t._v("中对文件的删除操作，但是保留了"),v("strong",[t._v("工作区")]),t._v("中对文件的删除操作。所以，工作区中的"),v("code",[t._v("test.txt")]),t._v("文件仍然处于删除了三行内容的状态。")]),t._v(" "),v("p",[t._v("此时只需要将修改操作从阶段"),v("code",[t._v("1")]),t._v("移动到修改前的阶段"),v("code",[t._v("0")]),t._v("，即可将文件恢复到修改前的状态，并清空工作区。可以采用"),v("code",[t._v("git restore test.txt")]),t._v("实现：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/16.png",alt:"image-20200406202716247"}})])])]),t._v(" "),v("h3",{attrs:{id:"ⅱ-git-revert"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ⅱ-git-revert"}},[t._v("#")]),t._v(" Ⅱ."),v("code",[t._v("git revert")])]),t._v(" "),v("p",[v("code",[t._v("revert")]),t._v("是回滚，重做的意思。不同于"),v("code",[t._v("reset")]),t._v("直接通过改变分支指向来进行版本回退，并且不产生新的提交；"),v("code",[t._v("revert")]),t._v("是通过额外创建一次提交，来取消分支上指定的某次提交的方式，来实现版本回退的。如下图所示，假如想要重做提交"),v("code",[t._v("B")]),t._v("，重做前与重做后的状态为：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/17.png",alt:"image-20200413234440432"}})]),t._v(" "),v("p",[t._v("所谓重做提交"),v("code",[t._v("B")]),t._v("，指的是在新建的提交"),v("code",[t._v("B'")]),t._v("中取消提交"),v("code",[t._v("B")]),t._v("中所做的一切操作。也就是说"),v("code",[t._v("revert")]),t._v("的思想为：通过创建一个新提交来取消不要的提交。所以，提交数会增加。")]),t._v(" "),v("h4",{attrs:{id:"_1-参数-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-参数-2"}},[t._v("#")]),t._v(" 1.参数")]),t._v(" "),v("p",[v("code",[t._v("git")]),t._v("同样为"),v("code",[t._v("revert")]),t._v("提供了许多参数，常用的有以下三种。为了演示它们的作用，首先需要设置对应的测试环境：在"),v("code",[t._v("dev")]),t._v("分支上进行四次提交，每次提交都为"),v("code",[t._v("test.txt")]),t._v("添加一行内容：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/18.png",alt:"image-20200414000404304"}})]),t._v(" "),v("h5",{attrs:{id:"e"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#e"}},[t._v("#")]),t._v(" "),v("code",[t._v("-e")])]),t._v(" "),v("p",[v("code",[t._v("-e")]),t._v("参数是"),v("code",[t._v("--edit")]),t._v("的缩写，为"),v("code",[t._v("revert")]),t._v("指令的默认参数，即"),v("code",[t._v("git revert -e")]),t._v("等同于"),v("code",[t._v("git revert")]),t._v("。该参数的作用为在重做过程中，新建一次提交的同时编辑提交信息。比如通过以下命令重做上述的"),v("code",[t._v("dev2")]),t._v("提交：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git revert f4a95\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("执行该指令后会创建一次新的提交来取消提交"),v("code",[t._v("dev2")]),t._v("所做的一切操作，并且会进入"),v("code",[t._v("vim")]),t._v("编辑器，编辑新提交的提交注释：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/19.png",alt:"image-20200414115052089"}})]),t._v(" "),v("p",[t._v("如下图所示，提交"),v("code",[t._v("dev2")]),t._v("为文件"),v("code",[t._v("test.txt")]),t._v("添加的"),v("code",[t._v("dev2")]),t._v("文本被取消了，并且"),v("code",[t._v("dev")]),t._v("分支上多了一次提交：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/20.png",alt:"image-20200414114945783"}})]),t._v(" "),v("h5",{attrs:{id:"no-edit"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#no-edit"}},[t._v("#")]),t._v(" "),v("code",[t._v("--no-edit")])]),t._v(" "),v("p",[t._v("该参数的作用为不编辑由于"),v("code",[t._v("revert")]),t._v("重做，所新增提交的注释信息。如下图所示，通过：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git revert --no-edit f4a95b\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("重做提交"),v("code",[t._v("dev2")]),t._v("的过程中，并不会进入"),v("code",[t._v("vim")]),t._v("编辑器编辑新增提交的注释信息，而是采用默认的注释信息："),v("code",[t._v('Revert "dev2"')]),t._v("：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/21.png",alt:"image-20200414114748865"}})]),t._v(" "),v("h5",{attrs:{id:"n"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#n"}},[t._v("#")]),t._v(" "),v("code",[t._v("-n")])]),t._v(" "),v("p",[v("code",[t._v("-n")]),t._v("参数是"),v("code",[t._v("--no-commit")]),t._v("的简写形式，作用为对"),v("code",[t._v("revert")]),t._v("重做某次提交时所产生的修改，不进行提交，也就是不会新增一次提交；")]),t._v(" "),v("p",[t._v("如下图所示，这是"),v("code",[t._v("revert")]),t._v("指令通过新建提交"),v("code",[t._v("B'")]),t._v("来取消提交"),v("code",[t._v("B")]),t._v("的过程，分为"),v("code",[t._v("0~4")]),t._v("个阶段。不添加"),v("code",[t._v("-n")]),t._v("参数时，"),v("code",[t._v("revert")]),t._v("指令会产生一次额外提交"),v("code",[t._v("B'")]),t._v("，此时处于下图中的第"),v("code",[t._v("3")]),t._v("阶段。而使用"),v("code",[t._v("-n")]),t._v("参数时，虽然"),v("code",[t._v("revert")]),t._v("指令也会通过新建提交"),v("code",[t._v("B'")]),t._v("来重做提交"),v("code",[t._v("B")]),t._v("。但是，此时还处于生成提交"),v("code",[t._v("B'")]),t._v("的过程，还没有完全生成提交"),v("code",[t._v("B'")]),t._v("，也就是处于下图中的第"),v("code",[t._v("2")]),t._v("阶段。")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/22.png",alt:"image-20200414002942670"}})]),t._v(" "),v("p",[t._v("这种做法的好处是，允许我们干涉"),v("code",[t._v("revert")]),t._v("重做过程，手动进行提交。如下图所示，通过：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git revert -n f4a95\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("重做提交"),v("code",[t._v("dev2")]),t._v("的过程中，手动暂停了重做过程。虽然提交"),v("code",[t._v("dev2")]),t._v("对"),v("code",[t._v("test.txt")]),t._v("所做的修改已被撤销，但是这一重做操作还未进行提交：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/23.png",alt:"image-20200414120436217"}})]),t._v(" "),v("p",[t._v("这样我们既可以修改重做过程中不满意的地方，也可以随意添加注释。修改完后，通过手动提交的方式，完成重做（"),v("code",[t._v("REVERTING")]),t._v("）操作：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/24.png",alt:"image-20200414121147251"}})]),t._v(" "),v("h4",{attrs:{id:"_2-写法-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-写法-2"}},[t._v("#")]),t._v(" 2.写法")]),t._v(" "),v("p",[v("code",[t._v("revert")]),t._v("指令也有多种写法，下面介绍主要的几种。为了方便演示，下列指令都采用默认参数"),v("code",[t._v("-e")]),t._v("手动编辑每次新增提交的注释信息。")]),t._v(" "),v("h5",{attrs:{id:"git-revert-commit-id"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-revert-commit-id"}},[t._v("#")]),t._v(" "),v("code",[t._v("git revert commit_id")])]),t._v(" "),v("p",[t._v("这是最常用的写法，通过"),v("code",[t._v("commit_id")]),t._v("精准地选择想要重做的提交。分两种情况：")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("**情况一：**重做最新一次提交，不会发生冲突。")]),t._v(" "),v("p",[t._v("例如：通过以下指令，重做"),v("code",[t._v("dev")]),t._v("分支上最新的一次提交"),v("code",[t._v("dev2")]),t._v("：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git revert f4a95b\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("首先进入"),v("code",[t._v("vim")]),t._v("编辑器编辑新增提交的注释信息：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/25.png",alt:"image-20200414135326937"}})]),t._v(" "),v("p",[t._v("随后完成重做操作，如下图所示；可见提交"),v("code",[t._v("dev2")]),t._v("给"),v("code",[t._v("test.txt")]),t._v("添加的"),v("code",[t._v("dev2")]),t._v("内容被删除了，并且多出一次提交，说明重做成功：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/26.png",alt:"image-20200414140040443"}})])]),t._v(" "),v("li",[v("p",[t._v("**情况二：**重做非最新一次提交，会发生冲突。")]),t._v(" "),v("p",[t._v("例如：通过以下指令，重做"),v("code",[t._v("dev")]),t._v("分支上的第三次提交"),v("code",[t._v("dev1")]),t._v("：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git revert dbde45\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("会出现合并冲突：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/27.png",alt:"image-20200414140502098"}})]),t._v(" "),v("p",[t._v("使用"),v("code",[t._v("git mergetool")]),t._v("指令，通过"),v("code",[t._v("vim")]),t._v("编辑器的工具"),v("code",[t._v("vimdiff")]),t._v("显示冲突文件"),v("code",[t._v("test.txt")]),t._v("：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/28.png",alt:"image-20200414140645448"}})]),t._v(" "),v("p",[t._v("回车进入"),v("code",[t._v("vim")]),t._v("编辑器界面，解决冲突：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/29.png",alt:"image-20200414141354304"}})]),t._v(" "),v("p",[t._v("解决冲突之后，手动进行一次提交，完成"),v("code",[t._v("revert")]),t._v("过程：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/30.png",alt:"image-20200414142323103"}})])]),t._v(" "),v("li",[v("p",[v("strong",[t._v("为什么会出现冲突？")])]),t._v(" "),v("p",[t._v("通过上面的例子不难看出，"),v("code",[t._v("revert")]),t._v("操作生成的"),v("strong",[t._v("新提交其实是通过两次提交合并而成")]),t._v("的。如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/31.png",alt:"image-20200414143430837"}})]),t._v(" "),v("ul",[v("li",[t._v("首先，将被重做的提交"),v("code",[t._v("dev1")]),t._v("的前一次提交"),v("code",[t._v("2nd")]),t._v("复制一份，即图中的"),v("code",[t._v("2nd'")]),t._v("；")]),t._v(" "),v("li",[t._v("然后，将它与当前分支的最新提交"),v("code",[t._v("dev2")]),t._v("进行合并，由此生成"),v("code",[t._v("revert")]),t._v("操作新增的提交；")])]),t._v(" "),v("p",[t._v("知道了"),v("code",[t._v("revert")]),t._v("操作新增的提交的由来后，就不难解释为什么会出现合并冲突了，如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/32.png",alt:"image-20200414144109389"}})]),t._v(" "),v("p",[t._v("合并的两次提交中，文件"),v("code",[t._v("test.txt")]),t._v("的内容不一样。"),v("code",[t._v("git")]),t._v("不知道以哪个版本为准，自然会导致自动合并失败，需要手动合并。")])])]),t._v(" "),v("h5",{attrs:{id:"git-revert-head"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-revert-head"}},[t._v("#")]),t._v(" "),v("code",[t._v("git revert HEAD")])]),t._v(" "),v("p",[t._v("该指令的作用为重做所在分支的最新一次提交，并且不会发生冲突：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/33.png",alt:"image-20200414150640086"}})]),t._v(" "),v("h5",{attrs:{id:"git-revert-head-2"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-revert-head-2"}},[t._v("#")]),t._v(" "),v("code",[t._v("git revert HEAD^")])]),t._v(" "),v("p",[t._v("该指令的作用为重做所在分支的倒数第二次提交，会发生冲突，需要手动合并，完成重做操作：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/34.png",alt:"image-20200414151002143"}})]),t._v(" "),v("h5",{attrs:{id:"git-revert-head-3"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-revert-head-3"}},[t._v("#")]),t._v(" "),v("code",[t._v("git revert HEAD^^")])]),t._v(" "),v("p",[t._v("该指令的作用为重做所在分支的倒数第三次提交，会发生冲突，需要手动合并，完成重做操作：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/35.png",alt:"image-20200414180953703"}})]),t._v(" "),v("h5",{attrs:{id:"git-revert-head-n"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-revert-head-n"}},[t._v("#")]),t._v(" "),v("code",[t._v("git revert HEAD~n")])]),t._v(" "),v("p",[t._v("该指令的作用为重做所在分支的倒数第"),v("code",[t._v("n+1")]),t._v("次提交，会发生冲突，需要手动合并，完成重做操作。过程与上述一致，这里就不再赘述了。")]),t._v(" "),v("blockquote",[v("p",[t._v("**总结：**常用"),v("code",[t._v("git revert commit_id")]),t._v("这种方式。")])]),t._v(" "),v("h4",{attrs:{id:"_3-撤销revert操作"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_3-撤销revert操作"}},[t._v("#")]),t._v(" 3.撤销"),v("code",[t._v("revert")]),t._v("操作")]),t._v(" "),v("p",[t._v("思路很简单，再次通过"),v("code",[t._v("revert")]),t._v("操作取消上一次的"),v("code",[t._v("revert")]),t._v('操作（即所谓"负负得正"）。')]),t._v(" "),v("p",[t._v("操作前，"),v("code",[t._v("dev")]),t._v("分支上的提交记录和"),v("code",[t._v("test.txt")]),t._v("文件内容如下：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/36.png",alt:"image-20200414153206034"}})]),t._v(" "),v("p",[t._v("通过："),v("code",[t._v("git revert --no-edit f4a95")]),t._v("重做提交"),v("code",[t._v("dev2")]),t._v("（"),v("code",[t._v("--no-edit")]),t._v("表示不修改新增提交的注释）：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/37.png",alt:"image-20200414153456451"}})]),t._v(" "),v("p",[t._v("重做后，多了一次提交，并且"),v("code",[t._v("test.txt")]),t._v("文件中删除了"),v("code",[t._v("dev2")]),t._v("这一行内容。此时，可以通过：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git revert --no-edit 582d127\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("重做上一次重做操作，以此达到取消上一次重做操作的目的：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/38.png",alt:"image-20200414153724455"}})]),t._v(" "),v("p",[t._v("如上图所示，虽然多出了一次提交，但是"),v("code",[t._v("test.txt")]),t._v("文件中被删除的"),v("code",[t._v("dev2")]),t._v("内容被恢复了，这样就撤销了"),v("code",[t._v("revert")]),t._v("操作。")]),t._v(" "),v("h3",{attrs:{id:"ⅲ-git-checkout"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ⅲ-git-checkout"}},[t._v("#")]),t._v(" Ⅲ."),v("code",[t._v("git checkout")])]),t._v(" "),v("h4",{attrs:{id:"_1-git-checkout-commit-id"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-git-checkout-commit-id"}},[t._v("#")]),t._v(" 1."),v("code",[t._v("git checkout commit_id")])]),t._v(" "),v("p",[t._v("使用"),v("code",[t._v("checkout")]),t._v("可以进行版本回退，如直接使用：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git checkout cb214 \n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("回退到提交"),v("code",[t._v("3rd")]),t._v("，此时会出现如下提示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/39.png",alt:"image-20200311111540863"}})]),t._v(" "),v("p",[t._v("注意到，切换后"),v("code",[t._v("HEAD")]),t._v("指向的不再是"),v("code",[t._v("master")]),t._v("分支，而是"),v("code",[t._v("cb214...")]),t._v("即第三次提交，查看历史提交记录：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/40.png",alt:"image-20200311111719389"}})]),t._v(" "),v("p",[t._v("可看到只有"),v("code",[t._v("3")]),t._v("次提交，什么意思呢？如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/41.png",alt:"image-20200412001646768"}})]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/42.png",alt:"image-20200311112656834"}})]),t._v(" "),v("p",[t._v("通过"),v("code",[t._v("git checkout")]),t._v("让"),v("code",[t._v("HEAD")]),t._v("指针指向了第"),v("code",[t._v("3")]),t._v("次提交，可以将它想象为一个新的分支。但是却没有实际创建分支，即此时"),v("code",[t._v("head")]),t._v("指向的由提交"),v("code",[t._v("1~3")]),t._v("组成的"),v("code",[t._v("commit")]),t._v("对象链条处于游离状态；")]),t._v(" "),v("p",[t._v("接着，在"),v("code",[t._v("HEAD")]),t._v("还指向游离的提交节点"),v("code",[t._v("3")]),t._v("的基础上对文件做出新的修改：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/43.png",alt:"image-20200311113237150"}})]),t._v(" "),v("ul",[v("li",[t._v("此时如果我们切换回"),v("code",[t._v("master")]),t._v("分支，会出现下列错误")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/44.png",alt:"image-20200311113209483"}})]),t._v(" "),v("p",[t._v("提示显示：如果没有保存就从游离的提交上切换到"),v("code",[t._v("master")]),t._v("分支，这一修改就会被"),v("code",[t._v("checkout")]),t._v("命令覆盖。我们可以在切换前进行一次提交操作：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/45.png",alt:"image-20200311113625297"}})]),t._v(" "),v("p",[t._v("此时的状态为：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/46.png",alt:"image-20200412002213790"}})]),t._v(" "),v("ul",[v("li",[t._v("在游离的"),v("code",[t._v("Commit")]),t._v("对象链中进行了一次提交之后，再次通过："),v("code",[t._v("git checkout master")]),t._v("切换到"),v("code",[t._v("master")]),t._v("分支：")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/47.png",alt:"image-20200311114055018"}})]),t._v(" "),v("p",[t._v("提示大意为：如果没有任何分支指向刚才在游离的"),v("code",[t._v("Commit")]),t._v("对象链中进行的提交，那么该提交就会被忽略。此时的状态如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/48.png",alt:"image-20200412002655921"}})]),t._v(" "),v("p",[t._v("如果想要创建一个分支保存（指向）这条游离的"),v("code",[t._v("Commit")]),t._v("对象链，现在就是很好的时机。根据上述提示的命令：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git branch mycommit  c4d5cc3\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("创建指向"),v("code",[t._v("commit_id")]),t._v("为"),v("code",[t._v("c4d5cc3")]),t._v("的提交（即上述的提交节点"),v("code",[t._v("5")]),t._v("）的分支"),v("code",[t._v("mycommit")]),t._v("：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/49.png",alt:"image-20200311115117279"}})]),t._v(" "),v("p",[t._v("由此游离的"),v("code",[t._v("commit")]),t._v("对象链得以被新分支所指向，并得到了保存，此时的状态如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/50.png",alt:"image-20200412004042471"}})]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("总结：")])]),t._v(" "),v("ul",[v("li",[v("p",[t._v("通过"),v("code",[t._v("checkout")]),t._v("进行版本回退会造成游离的提交对象链，需要额外创建一个分支进行保存；")])]),t._v(" "),v("li",[v("p",[t._v("因此，使用"),v("code",[t._v("checkout")]),t._v("进行版本回退的思路为，先切换到想要回退的提交版本，再删除进行版本回退的分支"),v("code",[t._v("dev")]),t._v("。最后，创建一个新的"),v("code",[t._v("dev")]),t._v("分支指向游离的提交对象链，完成分支"),v("code",[t._v("dev")]),t._v('的版本回退，简称"偷天换日"；')])]),t._v(" "),v("li",[v("p",[t._v("只要有分支指向，提交就不会被丢弃。")])])])]),t._v(" "),v("h3",{attrs:{id:"ⅳ-revert与reset的选择"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ⅳ-revert与reset的选择"}},[t._v("#")]),t._v(" Ⅳ."),v("code",[t._v("revert")]),t._v("与"),v("code",[t._v("reset")]),t._v("的选择")]),t._v(" "),v("p",[t._v("由于"),v("code",[t._v("checkout")]),t._v("会造成游离的提交对象链，所以，一般不使用"),v("code",[t._v("checkout")]),t._v("而是使用"),v("code",[t._v("reset")]),t._v("和"),v("code",[t._v("revert")]),t._v("进行版本回退：")]),t._v(" "),v("ul",[v("li",[v("p",[v("code",[t._v("revert")]),t._v("通过创建一个新提交的方式来撤销某次操作，该操作之前和之后的提交记录都会被保留，并且会将该撤销操作作为最新的提交；")])]),t._v(" "),v("li",[v("p",[v("code",[t._v("reset")]),t._v("是通过改变"),v("code",[t._v("HEAD")]),t._v("和分支指针指向的方式，进行版本回退，该操作之后的提交记录不会被保留，并且不会创建新的提交；")])])]),t._v(" "),v("p",[t._v("在个人开发上，建议使用"),v("code",[t._v("reset")]),t._v("；但是在团队开发中建议使用"),v("code",[t._v("revert")]),t._v("，特别是公共的分支（比如"),v("code",[t._v("master")]),t._v(")，这样能够完整保留提交历史，方便回溯。")]),t._v(" "),v("h3",{attrs:{id:"ⅴ-回退方法汇总"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#ⅴ-回退方法汇总"}},[t._v("#")]),t._v(" Ⅴ.回退方法汇总")]),t._v(" "),v("p",[t._v("版本回退主要有"),v("strong",[t._v("三大方式")]),t._v("："),v("code",[t._v("reset")]),t._v("、"),v("code",[t._v("revert")]),t._v("和"),v("code",[t._v("checkout")]),t._v("，各方式的比较如下：")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"center"}},[t._v("方法")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("效果")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("向前回退")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("向后回退")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("同步修改"),v("code",[t._v("HEAD")]),t._v("与分支指向")])])]),t._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git reset --hard HEAD^")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("往前回退"),v("code",[t._v("1")]),t._v("次提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git reset --hard HEAD^^")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("往前回退"),v("code",[t._v("2")]),t._v("次提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git reset --hard HEAD~n")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("往前回退"),v("code",[t._v("n")]),t._v("次提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git reset --hard <commit_id>")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("回退到指定"),v("code",[t._v("commit id")]),t._v("的提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git revert HEAD")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("重做最新一次提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git revert HEAD^")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("重做倒数第二次提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git revert HEAD^^")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("重做倒数第三次提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git revert HEAD~n")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("重做倒数第"),v("code",[t._v("n+1")]),t._v("次提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git revert commit_id")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("重做指定"),v("code",[t._v("commit_id")]),t._v("的提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("是")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("git checkout commit_id")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("回退到指定"),v("code",[t._v("commit id")]),t._v("的提交")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("能")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("否")])])])]),t._v(" "),v("p",[t._v("从上表可知，只有下列三种方式可以自由地向前向后回退：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git reset --hard commit_id\ngit revert commit_id\ngit checkout commit_id\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br"),v("span",{staticClass:"line-number"},[t._v("2")]),v("br"),v("span",{staticClass:"line-number"},[t._v("3")]),v("br")])]),v("p",[t._v("但是，使用"),v("code",[t._v("checkout")]),t._v("进行回退会出现游离的提交，需要创建一个新分支进行保存，所以不常用。")]),t._v(" "),v("h2",{attrs:{id:"二、git-stash"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#二、git-stash"}},[t._v("#")]),t._v(" 二、"),v("code",[t._v("git stash")])]),t._v(" "),v("h4",{attrs:{id:"_1-git-stash的作用"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_1-git-stash的作用"}},[t._v("#")]),t._v(" 1."),v("code",[t._v("git stash")]),t._v("的作用")]),t._v(" "),v("p",[v("code",[t._v("git stash")]),t._v("指令的作用为：对没有提交到版本库的，位于工作区或暂存区中游离的修改进行保存，在需要时可进行恢复。具体应用场景如下：")]),t._v(" "),v("p",[t._v("在"),v("code",[t._v("master")]),t._v("分支进行两次提交："),v("code",[t._v("1st")]),t._v("和"),v("code",[t._v("2nd")]),t._v("，随后创建并切换到"),v("code",[t._v("dev")]),t._v("分支。在"),v("code",[t._v("dev")]),t._v("分支上进行一次提交（"),v("code",[t._v("dev1")]),t._v("），此时两分支的状态为：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/51.png",alt:"image-20200412235844426"}})]),t._v(" "),v("p",[t._v("随后在"),v("code",[t._v("dev")]),t._v("分支上给文件"),v("code",[t._v("test.txt")]),t._v("添加一行"),v("code",[t._v("dev2")]),t._v("，但是不提交到暂存区，直接切换到"),v("code",[t._v("master")]),t._v("分支，会出现如下错误：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/52.png",alt:"image-20200413001632846"}})]),t._v(" "),v("p",[t._v("图中显示的错误大意为：在"),v("code",[t._v("dev")]),t._v("分支上的修改会被"),v("code",[t._v("checkout")]),t._v("操作覆盖。下面我们来看看，将"),v("code",[t._v("dev")]),t._v("分支上的这一修改操作添加到暂存区后，再切换分支，是否还会出现同样的问题：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/53.png",alt:"image-20200413001752227"}})]),t._v(" "),v("p",[t._v("可见还是会出现该错误，这初步验证了位于工作区和暂存区中的修改都会被"),v("code",[t._v("checkout")]),t._v("操作覆盖的结论。原因如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/54.png",alt:"image-20200413001917190"}})]),t._v(" "),v("p",[t._v("虽然在"),v("code",[t._v("dev")]),t._v("分支上修改了文件，但是没有将这一修改操作进行提交。这样就不会产生提交节点，就如上图所示，修改"),v("code",[t._v("dev2")]),t._v("是游离的，在切换分支的时候会被丢弃。")]),t._v(" "),v("p",[t._v("这种情况在日常开发中很常见，当在"),v("code",[t._v("develop")]),t._v("分支上开发新功能的时候，"),v("code",[t._v("master")]),t._v("分支出现紧急情况需要切换回去进行修复。但是，当前分支的新功能还没开发完全，贸然切换分支，原来开发的内容就会因被覆盖而丢失，怎么办呢？")]),t._v(" "),v("p",[t._v("有人可能会说进行一次"),v("code",[t._v("commit")]),t._v("不就可以了吗？确实可以。但是，这样不符合提交的代码就是正确代码的原则。更好的解决方法为使用"),v("code",[t._v("git stash")]),t._v("，如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/55.png",alt:"image-20200413002115302"}})]),t._v(" "),v("p",[t._v("可见"),v("code",[t._v("git stash")]),t._v("可以将当前"),v("code",[t._v("dev")]),t._v("分支上，位于在工作区或暂存区中的修改，在未提交的情况下进行了保存；并且将分支回退到修改前的状态，保存过后，就可以很顺畅地切换回"),v("code",[t._v("master")]),t._v("分支了。")]),t._v(" "),v("blockquote",[v("p",[t._v("图中的"),v("code",[t._v("WIP")]),t._v("（"),v("code",[t._v("working in progress")]),t._v("）表示的是正在进行的工作；")])]),t._v(" "),v("p",[t._v("当我们在"),v("code",[t._v("master")]),t._v("分支上完成了工作，再次切换回"),v("code",[t._v("dev")]),t._v("分支时，查看"),v("code",[t._v("test.txt")]),t._v("文件：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/56.png",alt:"image-20200413002256321"}})]),t._v(" "),v("p",[t._v("发现切换分支前所做的修改"),v("code",[t._v("dev2")]),t._v("消失了，这是为什么呢？")]),t._v(" "),v("ul",[v("li",[v("p",[t._v("其实，上面通过"),v("code",[t._v("git stash")]),t._v("将"),v("code",[t._v("dev")]),t._v("分支上工作区或暂存区中的修改，提交到了"),v("code",[t._v("stash")]),t._v("区域进行保存，并将"),v("code",[t._v("dev")]),t._v("分支回退到修改前的状态。如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/57.png",alt:"image-20200413003349365"}})])]),t._v(" "),v("li",[v("p",[t._v("切换到"),v("code",[t._v("master")]),t._v("分支时"),v("code",[t._v("test")]),t._v("分支上的修改依旧会被覆盖。所以，再次回到"),v("code",[t._v("dev")]),t._v("分支时需要从"),v("code",[t._v("stash")]),t._v("区域中恢复切换分支前保存的修改；")])])]),t._v(" "),v("p",[t._v("怎样恢复通过"),v("code",[t._v("git stash")]),t._v("保存到"),v("code",[t._v("stash")]),t._v("中的修改呢？可以通过：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git stash list\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[t._v("查看该分支上被"),v("code",[t._v("stash")]),t._v("保存的修改：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/58.png",alt:"image-20200413224408623"}})]),t._v(" "),v("p",[t._v("继续给"),v("code",[t._v("test.txt")]),t._v("文件添加内容："),v("code",[t._v("dev3")]),t._v("，并通过以下指令保存修改的同时添加注释：")]),t._v(" "),v("div",{staticClass:"language- line-numbers-mode"},[v("pre",{pre:!0,attrs:{class:"language-text"}},[v("code",[t._v("git stash save '注释'\n")])]),t._v(" "),v("div",{staticClass:"line-numbers-wrapper"},[v("span",{staticClass:"line-number"},[t._v("1")]),v("br")])]),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/59.png",alt:"image-20200413225024618"}})]),t._v(" "),v("ul",[v("li",[t._v("首先，通过上述命令可以修改"),v("code",[t._v("stash")]),t._v("中存储修改的备注信息；")]),t._v(" "),v("li",[t._v("其次，虽然在"),v("code",[t._v("test")]),t._v("分支上进行了两次修改，但是使用"),v("code",[t._v("git stash")]),t._v("保存修改后，文件"),v("code",[t._v("test.txt")]),t._v("并没有实际被修改；")])]),t._v(" "),v("h4",{attrs:{id:"_2-恢复stash存储的修改"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_2-恢复stash存储的修改"}},[t._v("#")]),t._v(" 2.恢复"),v("code",[t._v("stash")]),t._v("存储的修改")]),t._v(" "),v("p",[t._v("方法有很多，主要有以下三种：")]),t._v(" "),v("h5",{attrs:{id:"git-stash-pop"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-stash-pop"}},[t._v("#")]),t._v(" "),v("code",[t._v("git stash pop")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/60.png",alt:"image-20200413225140030"}})]),t._v(" "),v("p",[t._v("如图所示，通过上述命令将"),v("code",[t._v("stash")]),t._v("中存储的最新一次修改恢复了。相信你已经发现了，"),v("code",[t._v("stash")]),t._v("与"),v("strong",[t._v("栈")]),t._v("非常类似：先保存的修改，排在最后，序号最大；后保存的修改，排在最前，序号最小；")]),t._v(" "),v("p",[t._v("恢复了最新一次修改后，再次查看"),v("code",[t._v("stash")]),t._v("：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/61.png",alt:"image-20200413225221071"}})]),t._v(" "),v("p",[t._v("可以看到存储的修改只剩下一条了，由此可推断出"),v("code",[t._v("git stash pop")]),t._v("作用为：")]),t._v(" "),v("ul",[v("li",[t._v("**第一：**恢复"),v("code",[t._v("stash")]),t._v("中存储的最新一次修改；")]),t._v(" "),v("li",[t._v("**第二：**将该修改从"),v("code",[t._v("stash")]),t._v("中删除；")])]),t._v(" "),v("h5",{attrs:{id:"git-stash-apply"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-stash-apply"}},[t._v("#")]),t._v(" "),v("code",[t._v("git stash apply")])]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/62.png",alt:"image-20200413225457480"}})]),t._v(" "),v("p",[t._v("如上图所示，使用该指令时发生了合并冲突。这是因为，"),v("code",[t._v("stash")]),t._v("中保存的每一次修改代表的都是一个版本。")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/63.png",alt:"image-20200413231349820"}})]),t._v(" "),v("ul",[v("li",[v("p",[t._v("如上图所示，在"),v("code",[t._v("test")]),t._v("分支上，进行第一次修改后，通过"),v("code",[t._v("git stash")]),t._v("将该修改作为修改"),v("code",[t._v("0")]),t._v("保存到"),v("code",[t._v("stash")]),t._v("中，此时分支中的文件并没有发生改变；")])]),t._v(" "),v("li",[v("p",[t._v("进行第二次修改后，通过"),v("code",[t._v("git stash")]),t._v("将修改作为修改"),v("code",[t._v("1")]),t._v("保存到"),v("code",[t._v("stash")]),t._v("中，分支中的文件依旧没有发生改变；此时的"),v("code",[t._v("stash")]),t._v("中相当于保存着同一分支上两个修改后的版本；")])]),t._v(" "),v("li",[v("p",[t._v("此时通过**"),v("code",[t._v("git stash pop")]),v("strong",[t._v("取出修改"),v("code",[t._v("0")]),t._v("，与"),v("code",[t._v("test")]),t._v("分支进行合并；再通过")]),v("code",[t._v("git stash pop")]),t._v("**取出修改"),v("code",[t._v("1")]),t._v("，再次与"),v("code",[t._v("test")]),t._v("分支进行合并，两个版本合并自然会产生冲突。")])])]),t._v(" "),v("p",[t._v("手动解决冲突后，要进行一次提交才算完成了手动合并；随后查看"),v("code",[t._v("stash")]),t._v("：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/64.png",alt:"image-20200413230750201"}})]),t._v(" "),v("p",[t._v("修改"),v("code",[t._v("0")]),t._v("仍然存在，说明**"),v("code",[t._v("git stash apply")]),t._v("**的作用为取出"),v("code",[t._v("stash")]),t._v("中最新（前面）的修改并与分支进行合并。但是，"),v("code",[t._v("stash")]),t._v("中存储的该修改并不会被删除；")]),t._v(" "),v("h5",{attrs:{id:"git-stash-apply-stash-n"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#git-stash-apply-stash-n"}},[t._v("#")]),t._v(" "),v("code",[t._v("git stash apply stash@{n}")])]),t._v(" "),v("p",[t._v("这是最常用的方法，作用为从"),v("code",[t._v("stash")]),t._v("中恢复特定的修改，并且不删除"),v("code",[t._v("stash")]),t._v("中的该修改。")]),t._v(" "),v("p",[t._v("将"),v("code",[t._v("test.txt")]),t._v("的两次修改通过"),v("code",[t._v("git stash")]),t._v("存储到"),v("code",[t._v("stash")]),t._v("中，如下图所示：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/65.png",alt:"image-20200413232024080"}})]),t._v(" "),v("p",[t._v("通过**"),v("code",[t._v("git stash apply stash@{1}")]),t._v("**恢复"),v("code",[t._v("stash")]),t._v("中存储的修改"),v("code",[t._v("1")]),t._v("：")]),t._v(" "),v("p",[v("img",{attrs:{src:"http://ahuntsun.gitee.io/blogimagebed/img/git/lesson4/66.png",alt:"image-20200413232309330"}})]),t._v(" "),v("p",[t._v("如上图所示，成功地恢复了"),v("code",[t._v("stash")]),t._v("中的修改"),v("code",[t._v("1")]),t._v("，并且"),v("code",[t._v("stash")]),t._v("中的修改"),v("code",[t._v("1")]),t._v("并没有被删除；")]),t._v(" "),v("p",[v("strong",[t._v("总结：")])]),t._v(" "),v("ul",[v("li",[v("code",[t._v("git stash pop")]),t._v("：恢复并删除"),v("code",[t._v("stash")]),t._v("中存储的最新修改；")]),t._v(" "),v("li",[v("code",[t._v("git stash apply")]),t._v("：恢复但不删除"),v("code",[t._v("stash")]),t._v("中存储的最新修改；")]),t._v(" "),v("li",[v("code",[t._v("git stash apply stash@{0}")]),t._v("：恢复但不删除"),v("code",[t._v("stash")]),t._v("中存储的特定提交；")])])])}),[],!1,null,null,null);e.default=s.exports}}]);